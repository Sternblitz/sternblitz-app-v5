"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/sign/submit/route";
exports.ids = ["app/api/sign/submit/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "async_hooks":
/*!******************************!*\
  !*** external "async_hooks" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("async_hooks");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsign%2Fsubmit%2Froute&page=%2Fapi%2Fsign%2Fsubmit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsign%2Fsubmit%2Froute.js&appDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsign%2Fsubmit%2Froute&page=%2Fapi%2Fsign%2Fsubmit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsign%2Fsubmit%2Froute.js&appDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_lanoaziz_Desktop_sternblitz_app_v3_app_api_sign_submit_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/sign/submit/route.js */ \"(rsc)/./app/api/sign/submit/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/sign/submit/route\",\n        pathname: \"/api/sign/submit\",\n        filename: \"route\",\n        bundlePath: \"app/api/sign/submit/route\"\n    },\n    resolvedPagePath: \"/Users/lanoaziz/Desktop/sternblitz-app-v3/app/api/sign/submit/route.js\",\n    nextConfigOutput,\n    userland: _Users_lanoaziz_Desktop_sternblitz_app_v3_app_api_sign_submit_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/sign/submit/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzaWduJTJGc3VibWl0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZzaWduJTJGc3VibWl0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2lnbiUyRnN1Ym1pdCUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRmxhbm9heml6JTJGRGVza3RvcCUyRnN0ZXJuYmxpdHotYXBwLXYzJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmxhbm9heml6JTJGRGVza3RvcCUyRnN0ZXJuYmxpdHotYXBwLXYzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzQjtBQUNuRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3N0ZXJuYmxpdHotc2FsZXMvPzQwNjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2xhbm9heml6L0Rlc2t0b3Avc3Rlcm5ibGl0ei1hcHAtdjMvYXBwL2FwaS9zaWduL3N1Ym1pdC9yb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2lnbi9zdWJtaXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zaWduL3N1Ym1pdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc2lnbi9zdWJtaXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbGFub2F6aXovRGVza3RvcC9zdGVybmJsaXR6LWFwcC12My9hcHAvYXBpL3NpZ24vc3VibWl0L3JvdXRlLmpzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zaWduL3N1Ym1pdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsign%2Fsubmit%2Froute&page=%2Fapi%2Fsign%2Fsubmit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsign%2Fsubmit%2Froute.js&appDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/sign/submit/route.js":
/*!**************************************!*\
  !*** ./app/api/sign/submit/route.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var pdf_lib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pdf-lib */ \"(rsc)/./node_modules/pdf-lib/es/index.js\");\n/* harmony import */ var resend__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! resend */ \"(rsc)/./node_modules/resend/dist/index.mjs\");\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./lib/supabaseServer.js\");\n/* harmony import */ var _lib_supabaseServerAuth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/supabaseServerAuth */ \"(rsc)/./lib/supabaseServerAuth.js\");\n// app/api/sign/submit/route.js\n\n\n\n\n\nconst runtime = \"nodejs\"; // Node, nicht Edge\n// ---------- Helpers ----------\nfunction dataUrlToUint8(signaturePng) {\n    const base64 = (signaturePng || \"\").split(\",\").pop() || \"\";\n    const bin = Buffer.from(base64, \"base64\");\n    return new Uint8Array(bin);\n}\n// WinAnsi: Emojis entfernen\nfunction toWinAnsi(text = \"\") {\n    return String(text).replace(/[\\u{1F300}-\\u{1FAFF}\\u{1F000}-\\u{1F9FF}\\u{2600}-\\u{27BF}]/gu, \"\");\n}\nfunction labelFor(opt) {\n    return opt === \"123\" ? \"1–3 Sterne l\\xf6schen\" : opt === \"12\" ? \"1–2 Sterne l\\xf6schen\" : opt === \"1\" ? \"1 Stern l\\xf6schen\" : \"Individuelle L\\xf6schungen\";\n}\nfunction chosenCount(selectedOption, counts) {\n    if (!counts) return null;\n    if (selectedOption === \"123\") return counts.c123 ?? null;\n    if (selectedOption === \"12\") return counts.c12 ?? null;\n    if (selectedOption === \"1\") return counts.c1 ?? null;\n    return null;\n}\nfunction safeFileBase(name) {\n    return (name || \"kunde\").toString().trim().replace(/[^a-z0-9_-]+/gi, \"_\") || \"kunde\";\n}\nfunction makePromoCode(firstName = \"\", lastName = \"\") {\n    const fn = (firstName || \"\").toLowerCase().replace(/[^a-z0-9]/g, \"\");\n    const ln = (lastName || \"\").toLowerCase().replace(/[^a-z0-9]/g, \"\");\n    const firstL = ln.slice(0, 1);\n    const lastL = ln.slice(-1);\n    return `${fn}${firstL}${lastL}25`;\n}\nfunction isValidFromOrReplyTo(s = \"\") {\n    return /^[^<>\\s@]+@[^<>\\s@]+\\.[^<>\\s@]+$/.test(s) || /^[^<>]+<[^<>\\s@]+@[^<>\\s@]+\\.[^<>]+>$/.test(s);\n}\nfunction storageKeyFor(fileName, repCode) {\n    const d = new Date();\n    const yyyy = d.getFullYear();\n    const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n    const folder = repCode ? `${yyyy}/${mm}/${repCode}` : `${yyyy}/${mm}`;\n    return `${folder}/${fileName}`;\n}\nfunction sanitizeCounts(raw) {\n    if (!raw || typeof raw !== \"object\") return null;\n    const keys = [\n        \"c123\",\n        \"c12\",\n        \"c1\"\n    ];\n    const cleaned = {};\n    for (const key of keys){\n        const value = Number(raw[key]);\n        if (Number.isFinite(value)) cleaned[key] = value;\n    }\n    return Object.keys(cleaned).length ? cleaned : null;\n}\nfunction cleanString(value) {\n    if (typeof value !== \"string\") return null;\n    const trimmed = value.trim();\n    return trimmed.length ? trimmed : null;\n}\n// ---------- PDF ----------\nasync function buildPdf(p, sigBytes) {\n    const pdf = await pdf_lib__WEBPACK_IMPORTED_MODULE_1__.PDFDocument.create();\n    const page = pdf.addPage([\n        595,\n        842\n    ]); // A4\n    const { height } = page.getSize();\n    const font = await pdf.embedFont(pdf_lib__WEBPACK_IMPORTED_MODULE_1__.StandardFonts.Helvetica);\n    const bold = await pdf.embedFont(pdf_lib__WEBPACK_IMPORTED_MODULE_1__.StandardFonts.HelveticaBold);\n    const draw = (txt, opts)=>page.drawText(toWinAnsi(txt), opts);\n    let y = height - 70;\n    draw(\"Auftragsbest\\xe4tigung Sternblitz\", {\n        x: 50,\n        y,\n        font: bold,\n        size: 20,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    y -= 20;\n    draw(\"Hiermit best\\xe4tige ich den Auftrag zur L\\xf6schung meiner negativen Google-Bewertungen.\", {\n        x: 50,\n        y,\n        font,\n        size: 11,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    y -= 25;\n    for (const b of [\n        \"Fixpreis: 299 € (einmalig)\",\n        \"Zahlung erst nach L\\xf6schung (von mind. 90 % der Bewertungen)\",\n        \"Dauerhafte Entfernung\"\n    ]){\n        draw(\"• \" + b, {\n            x: 50,\n            y,\n            font,\n            size: 11,\n            color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n        });\n        y -= 16;\n    }\n    y -= 10;\n    draw(\"Zusammenfassung\", {\n        x: 50,\n        y,\n        font: bold,\n        size: 12,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    y -= 16;\n    const lines = [\n        [\n            \"Google-Profil\",\n            p.googleProfile\n        ],\n        [\n            \"Bewertungen\",\n            labelFor(p.selectedOption)\n        ],\n        [\n            \"Firma\",\n            p.company\n        ],\n        [\n            \"Vorname\",\n            p.firstName\n        ],\n        [\n            \"Nachname\",\n            p.lastName\n        ],\n        [\n            \"E-Mail\",\n            p.email\n        ],\n        [\n            \"Telefon\",\n            p.phone\n        ]\n    ];\n    for (const [k, v] of lines){\n        draw(`${k}:`, {\n            x: 50,\n            y,\n            font: bold,\n            size: 10,\n            color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n        });\n        draw(String(v ?? \"—\"), {\n            x: 180,\n            y,\n            font,\n            size: 10,\n            color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n        });\n        y -= 14;\n    }\n    const picked = chosenCount(p.selectedOption, p.counts);\n    y -= 6;\n    draw(\"Gew\\xe4hlte L\\xf6schung:\", {\n        x: 50,\n        y,\n        font: bold,\n        size: 10,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    draw(`${labelFor(p.selectedOption)}${picked != null ? ` — Entfernte: ${Number(picked).toLocaleString(\"de-DE\")}` : \"\"}`, {\n        x: 180,\n        y,\n        font,\n        size: 10,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    y -= 14;\n    if (p.counts) {\n        const c123 = Number(p.counts.c123 ?? 0).toLocaleString(\"de-DE\");\n        const c12 = Number(p.counts.c12 ?? 0).toLocaleString(\"de-DE\");\n        const c1 = Number(p.counts.c1 ?? 0).toLocaleString(\"de-DE\");\n        draw(\"Z\\xe4hler gesamt:\", {\n            x: 50,\n            y,\n            font: bold,\n            size: 10,\n            color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n        });\n        draw(`1–3: ${c123}   |   1–2: ${c12}   |   1: ${c1}`, {\n            x: 180,\n            y,\n            font,\n            size: 10,\n            color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n        });\n        y -= 14;\n    }\n    y -= 12;\n    draw(\"Unterschrift:\", {\n        x: 50,\n        y,\n        font: bold,\n        size: 11,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    y -= 100;\n    if (sigBytes?.length) {\n        const png = await pdf.embedPng(sigBytes);\n        page.drawImage(png, {\n            x: 50,\n            y,\n            width: 200,\n            height: 100\n        });\n    }\n    y -= 20;\n    draw(`Datum: ${new Date().toLocaleString(\"de-DE\")}`, {\n        x: 50,\n        y,\n        font,\n        size: 10,\n        color: (0,pdf_lib__WEBPACK_IMPORTED_MODULE_1__.rgb)(0, 0, 0)\n    });\n    return await pdf.save();\n}\n// ---------- Handler ----------\nasync function POST(req) {\n    try {\n        const body = await req.json();\n        const { googleProfile, googleUrl, selectedOption, company, firstName, lastName, email, phone, signaturePng, counts, rep_code = null, source_account_id = null } = body || {};\n        const normalizedGoogleProfile = typeof googleProfile === \"string\" ? googleProfile.trim() : googleProfile;\n        const normalizedGoogleUrl = cleanString(googleUrl);\n        if (!normalizedGoogleProfile || !signaturePng) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Ung\\xfcltige Daten\"\n            }, {\n                status: 400\n            });\n        }\n        const supabase = (0,_lib_supabaseServerAuth__WEBPACK_IMPORTED_MODULE_4__.supabaseServerAuth)();\n        const { data: { user }, error: userError } = await supabase.auth.getUser();\n        if (userError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: userError.message\n            }, {\n                status: 401\n            });\n        }\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Session erforderlich.\"\n            }, {\n                status: 401\n            });\n        }\n        const { data: profile, error: profileError } = await supabase.from(\"profiles\").select(\"user_id\").eq(\"user_id\", user.id).maybeSingle();\n        if (profileError) {\n            console.error(\"sign/submit profile error\", profileError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Profil konnte nicht geladen werden.\"\n            }, {\n                status: 500\n            });\n        }\n        if (!profile) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Kein Profil hinterlegt. Bitte Admin benachrichtigen.\"\n            }, {\n                status: 403\n            });\n        }\n        if (source_account_id && source_account_id !== user.id) {\n            console.warn(\"source_account_id does not match session user\", {\n                source_account_id,\n                user_id: user.id\n            });\n        }\n        // 1) PDF bauen\n        const sigBytes = dataUrlToUint8(signaturePng);\n        const pdfBytes = await buildPdf({\n            googleProfile: normalizedGoogleProfile,\n            selectedOption,\n            company,\n            firstName,\n            lastName,\n            email,\n            phone,\n            counts\n        }, sigBytes);\n        // 2) Upload zu Supabase Storage (Bucket: contracts)\n        const admin = (0,_lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseAdmin)();\n        const safeBase = safeFileBase(firstName);\n        const fileName = `${Date.now()}_${safeBase}.pdf`;\n        const key = storageKeyFor(fileName, rep_code || undefined);\n        const { error: uploadErr } = await admin.storage.from(\"contracts\").upload(key, Buffer.from(pdfBytes), {\n            contentType: \"application/pdf\",\n            upsert: false\n        });\n        if (uploadErr) throw uploadErr;\n        const { data: pub } = admin.storage.from(\"contracts\").getPublicUrl(key);\n        const pdfUrl = pub?.publicUrl || null;\n        // 3) Auftrag speichert sich über das RLS-fähige Client\n        const picked = chosenCount(selectedOption, counts);\n        const sanitizedCounts = sanitizeCounts(counts);\n        const orderPayload = {\n            google_profile: normalizedGoogleProfile,\n            google_url: normalizedGoogleUrl,\n            selected_option: cleanString(selectedOption),\n            counts: sanitizedCounts,\n            company: cleanString(company),\n            first_name: cleanString(firstName),\n            last_name: cleanString(lastName),\n            email: cleanString(email),\n            phone: cleanString(phone),\n            pdf_path: key,\n            pdf_signed_url: pdfUrl\n        };\n        if (rep_code && typeof rep_code === \"string\") {\n            const trimmed = rep_code.trim();\n            if (trimmed) orderPayload.rep_code = trimmed;\n        }\n        if (Number.isFinite(picked)) {\n            orderPayload.option_chosen_count = picked;\n        }\n        if (body && typeof body.customNotes !== \"undefined\") {\n            orderPayload.custom_notes = cleanString(body.customNotes);\n        }\n        const { data: insertedOrder, error: insertError } = await supabase.from(\"orders\").insert([\n            orderPayload\n        ]).select(\"id, created_at\").maybeSingle();\n        if (insertError) {\n            console.error(\"orders insert failed\", insertError);\n            try {\n                await admin.storage.from(\"contracts\").remove([\n                    key\n                ]);\n            } catch (cleanupErr) {\n                console.warn(\"orders insert cleanup failed\", cleanupErr);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Auftrag konnte nicht gespeichert werden.\"\n            }, {\n                status: 500\n            });\n        }\n        // 4) E-Mail via Resend\n        const resend = new resend__WEBPACK_IMPORTED_MODULE_2__.Resend(process.env.RESEND_API_KEY);\n        const FROM = process.env.RESEND_FROM || \"\";\n        const REPLY_TO = process.env.RESEND_REPLY_TO || \"\";\n        const ATTACH = String(process.env.EMAIL_ATTACH_PDF || \"\").toLowerCase() === \"true\";\n        const subject = \"Deine Auftragsbest\\xe4tigung – Sternblitz\";\n        const chosenLabel = labelFor(selectedOption);\n        const selectedCount = Number(chosenCount(selectedOption, counts) ?? 0);\n        const promo = makePromoCode(firstName, lastName);\n        const referralLink = `https://sternblitz.de/empfehlen?ref=DEMO`; // Platzhalter\n        const pdfLine = ATTACH ? \"Deine Auftragsbest\\xe4tigung (PDF) findest du im Anhang.\" : \"Deine Auftragsbest\\xe4tigung (PDF) wurde erstellt.\";\n        const html = `\n      <div style=\"font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.58;color:#0f172a;background:#ffffff;padding:0;margin:0\">\n        <div style=\"max-width:640px;margin:0 auto;padding:28px 20px 8px\">\n          <h1 style=\"margin:0 0 10px;font-size:20px;letter-spacing:.2px\">Hallo ${firstName || \"\"}!</h1>\n          <p style=\"margin:0 0 16px\">danke für deinen Auftrag. Wir starten jetzt mit der Entfernung der ausgewählten Bewertungen.</p>\n\n          <div style=\"border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;margin:18px 0;background:#f9fbff\">\n            <div style=\"font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:.06em;margin-bottom:6px\">Google-Profil</div>\n            <div style=\"font-weight:700\">${normalizedGoogleProfile ? normalizedGoogleProfile : \"—\"}</div>\n          </div>\n\n          <div style=\"border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;margin:12px 0;background:#ffffff\">\n            <div style=\"font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:.06em;margin-bottom:6px\">Auswahl</div>\n            <div style=\"font-weight:700\">${chosenLabel} → ${Number.isFinite(selectedCount) ? selectedCount : \"—\"} Stück</div>\n          </div>\n\n          <p style=\"margin:16px 0\">${pdfLine}</p>\n\n          <div style=\"margin:26px 0 10px;font-weight:800;font-size:16px\">Freunde werben & sparen</div>\n          <p style=\"margin:0 0 12px\">\n            Teile Sternblitz mit Freund:innen – <strong>sie sparen 25&nbsp;€</strong> auf die Auftragspauschale\n            und du erhältst für jede erfolgreiche Empfehlung einen <strong>25&nbsp;€ Amazon-Gutschein</strong>.\n          </p>\n\n          <div style=\"display:inline-block;padding:12px 14px;border:1px solid #e5e7eb;border-radius:12px;background:#f7fafc;margin-bottom:10px\">\n            <div style=\"font-size:12px;text-transform:uppercase;letter-spacing:.06em;color:#64748b\">Dein Promocode</div>\n            <div style=\"font-size:20px;font-weight:900;letter-spacing:.6px\">${promo}</div>\n            <div style=\"font-size:12px;color:#64748b\">Gültig 30 Tage · max. 5 Einlösungen</div>\n          </div>\n\n          <div style=\"margin:6px 0 22px;font-size:14px\">\n            Teilen-Link (Platzhalter):\n            <a href=\"${referralLink}\" target=\"_blank\" rel=\"noopener\" style=\"color:#0b6cf2;text-decoration:none\">${referralLink}</a>\n          </div>\n\n          <p style=\"color:#64748b;font-style:italic;margin-top:6px\">(Dies ist eine automatische Mail)</p>\n        </div>\n\n        <div style=\"max-width:640px;margin:0 auto;padding:0 20px 28px\">\n          <hr style=\"border:none;border-top:1px solid #e5e7eb;margin:14px 0 18px\"/>\n          <table role=\"presentation\" style=\"width:100%;border-collapse:collapse\">\n            <tr><td style=\"font-weight:900;padding:0 0 6px\">Sternblitz Auftragsservice</td></tr>\n            <tr><td style=\"padding:0 0 4px\">📧 <a href=\"mailto:info@sternblitz.de\" style=\"color:#0b6cf2;text-decoration:none\">info@sternblitz.de</a></td></tr>\n            <tr><td>🌐 <a href=\"https://sternblitz.de\" style=\"color:#0b6cf2;text-decoration:none\">sternblitz.de</a></td></tr>\n          </table>\n        </div>\n      </div>\n    `.trim();\n        const text = `Hallo ${firstName || \"\"}!\\n\\n` + `Danke für deinen Auftrag. Wir starten jetzt mit der Entfernung der ausgewählten Bewertungen.\\n\\n` + `Google-Profil: ${normalizedGoogleProfile || \"—\"}\\n` + `Auswahl: ${chosenLabel} → ${Number.isFinite(selectedCount) ? selectedCount : \"—\"} Stück\\n\\n` + `${pdfLine}\\n\\n` + `Freunde werben & sparen:\\n` + `• Deine Freunde sparen 25 € auf die Auftragspauschale\\n` + `• Du erhältst pro erfolgreicher Empfehlung einen 25 € Amazon-Gutschein\\n` + `Promocode: ${promo} (30 Tage gültig, max. 5 Einlösungen)\\n` + `Teilen-Link (Platzhalter): ${referralLink}\\n\\n` + `(Dies ist eine automatische Mail)\\n\\n` + `Sternblitz Auftragsservice\\n` + `info@sternblitz.de · sternblitz.de\\n`;\n        if (process.env.RESEND_API_KEY && isValidFromOrReplyTo(process.env.RESEND_FROM || \"\")) {\n            if (email) {\n                const payload = {\n                    from: process.env.RESEND_FROM,\n                    to: email,\n                    subject,\n                    html,\n                    text,\n                    headers: {\n                        \"X-Entity-Ref-ID\": key\n                    },\n                    ...isValidFromOrReplyTo(process.env.RESEND_REPLY_TO || \"\") ? {\n                        reply_to: process.env.RESEND_REPLY_TO\n                    } : {},\n                    ...ATTACH ? {\n                        attachments: [\n                            {\n                                filename: fileName,\n                                content: Buffer.from(pdfBytes),\n                                contentType: \"application/pdf\"\n                            }\n                        ]\n                    } : {}\n                };\n                const { error: mailErr } = await resend.emails.send(payload);\n                if (mailErr) console.warn(\"Resend error:\", mailErr);\n            } else {\n                console.warn(\"Kein Empf\\xe4nger (email) angegeben – E-Mail \\xfcbersprungen.\");\n            }\n        } else {\n            console.warn(\"E-Mail nicht gesendet: RESEND_API_KEY/RESEND_FROM fehlt oder ung\\xfcltig.\");\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            pdfUrl,\n            pdfPath: key,\n            orderId: insertedOrder?.id ?? null\n        });\n    } catch (e) {\n        console.error(\"sign/submit error:\", e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: e?.message || \"Fehler\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2RySyxNQUFNcUosUUFBUUMsR0FBRyxDQUFDRyxXQUFXO29CQUM3QmEsSUFBSXZGO29CQUNKK0U7b0JBQ0FNO29CQUNBaks7b0JBQ0FvSyxTQUFTO3dCQUFFLG1CQUFtQjFIO29CQUFJO29CQUNsQyxHQUFJbEIscUJBQXFCMEgsUUFBUUMsR0FBRyxDQUFDSyxlQUFlLElBQUksTUFBTTt3QkFBRWEsVUFBVW5CLFFBQVFDLEdBQUcsQ0FBQ0ssZUFBZTtvQkFBQyxJQUFJLENBQUMsQ0FBQztvQkFDNUcsR0FBSUMsU0FBUzt3QkFDWGEsYUFBYTs0QkFBQztnQ0FDWkMsVUFBVTNJO2dDQUNWNEksU0FBUzVLLE9BQU9DLElBQUksQ0FBQ3FIO2dDQUNyQlEsYUFBYTs0QkFDZjt5QkFBRTtvQkFDSixJQUFJLENBQUMsQ0FBQztnQkFDUjtnQkFDQSxNQUFNLEVBQUUxQixPQUFPeUUsT0FBTyxFQUFFLEdBQUcsTUFBTXhCLE9BQU95QixNQUFNLENBQUNDLElBQUksQ0FBQ1Q7Z0JBQ3BELElBQUlPLFNBQVMxRCxRQUFRQyxJQUFJLENBQUMsaUJBQWlCeUQ7WUFDN0MsT0FBTztnQkFDTDFELFFBQVFDLElBQUksQ0FBQztZQUNmO1FBQ0YsT0FBTztZQUNMRCxRQUFRQyxJQUFJLENBQUM7UUFDZjtRQUVBLE9BQU9sSSxxREFBWUEsQ0FBQzRHLElBQUksQ0FBQztZQUN2QmtGLElBQUk7WUFDSjlDO1lBQ0ErQyxTQUFTbkk7WUFDVG9JLFNBQVNsQyxlQUFlL0IsTUFBTTtRQUNoQztJQUNGLEVBQUUsT0FBT2tFLEdBQUc7UUFDVmhFLFFBQVFmLEtBQUssQ0FBQyxzQkFBc0IrRTtRQUNwQyxPQUFPak0scURBQVlBLENBQUM0RyxJQUFJLENBQUM7WUFBRU0sT0FBTytFLEdBQUd2RSxXQUFXO1FBQVMsR0FBRztZQUFFUCxRQUFRO1FBQUk7SUFDNUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0ZXJuYmxpdHotc2FsZXMvLi9hcHAvYXBpL3NpZ24vc3VibWl0L3JvdXRlLmpzPzg5MzEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwL2FwaS9zaWduL3N1Ym1pdC9yb3V0ZS5qc1xuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBQREZEb2N1bWVudCwgU3RhbmRhcmRGb250cywgcmdiIH0gZnJvbSBcInBkZi1saWJcIjtcbmltcG9ydCB7IFJlc2VuZCB9IGZyb20gXCJyZXNlbmRcIjtcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tIFwiQC9saWIvc3VwYWJhc2VTZXJ2ZXJcIjtcbmltcG9ydCB7IHN1cGFiYXNlU2VydmVyQXV0aCB9IGZyb20gXCJAL2xpYi9zdXBhYmFzZVNlcnZlckF1dGhcIjtcblxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSBcIm5vZGVqc1wiOyAvLyBOb2RlLCBuaWNodCBFZGdlXG5cbi8vIC0tLS0tLS0tLS0gSGVscGVycyAtLS0tLS0tLS0tXG5mdW5jdGlvbiBkYXRhVXJsVG9VaW50OChzaWduYXR1cmVQbmcpIHtcbiAgY29uc3QgYmFzZTY0ID0gKHNpZ25hdHVyZVBuZyB8fCBcIlwiKS5zcGxpdChcIixcIikucG9wKCkgfHwgXCJcIjtcbiAgY29uc3QgYmluID0gQnVmZmVyLmZyb20oYmFzZTY0LCBcImJhc2U2NFwiKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGJpbik7XG59XG5cbi8vIFdpbkFuc2k6IEVtb2ppcyBlbnRmZXJuZW5cbmZ1bmN0aW9uIHRvV2luQW5zaSh0ZXh0ID0gXCJcIikge1xuICByZXR1cm4gU3RyaW5nKHRleHQpLnJlcGxhY2UoXG4gICAgL1tcXHV7MUYzMDB9LVxcdXsxRkFGRn1cXHV7MUYwMDB9LVxcdXsxRjlGRn1cXHV7MjYwMH0tXFx1ezI3QkZ9XS9ndSxcbiAgICBcIlwiXG4gICk7XG59XG5cbmZ1bmN0aW9uIGxhYmVsRm9yKG9wdCkge1xuICByZXR1cm4gb3B0ID09PSBcIjEyM1wiID8gXCIx4oCTMyBTdGVybmUgbMO2c2NoZW5cIlxuICAgICAgIDogb3B0ID09PSBcIjEyXCIgID8gXCIx4oCTMiBTdGVybmUgbMO2c2NoZW5cIlxuICAgICAgIDogb3B0ID09PSBcIjFcIiAgID8gXCIxIFN0ZXJuIGzDtnNjaGVuXCJcbiAgICAgICA6IFwiSW5kaXZpZHVlbGxlIEzDtnNjaHVuZ2VuXCI7XG59XG5cbmZ1bmN0aW9uIGNob3NlbkNvdW50KHNlbGVjdGVkT3B0aW9uLCBjb3VudHMpIHtcbiAgaWYgKCFjb3VudHMpIHJldHVybiBudWxsO1xuICBpZiAoc2VsZWN0ZWRPcHRpb24gPT09IFwiMTIzXCIpIHJldHVybiBjb3VudHMuYzEyMyA/PyBudWxsO1xuICBpZiAoc2VsZWN0ZWRPcHRpb24gPT09IFwiMTJcIikgIHJldHVybiBjb3VudHMuYzEyICA/PyBudWxsO1xuICBpZiAoc2VsZWN0ZWRPcHRpb24gPT09IFwiMVwiKSAgIHJldHVybiBjb3VudHMuYzEgICA/PyBudWxsO1xuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gc2FmZUZpbGVCYXNlKG5hbWUpIHtcbiAgcmV0dXJuIChuYW1lIHx8IFwia3VuZGVcIikudG9TdHJpbmcoKS50cmltKCkucmVwbGFjZSgvW15hLXowLTlfLV0rL2dpLCBcIl9cIikgfHwgXCJrdW5kZVwiO1xufVxuXG5mdW5jdGlvbiBtYWtlUHJvbW9Db2RlKGZpcnN0TmFtZSA9IFwiXCIsIGxhc3ROYW1lID0gXCJcIikge1xuICBjb25zdCBmbiA9IChmaXJzdE5hbWUgfHwgXCJcIikudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0vZywgXCJcIik7XG4gIGNvbnN0IGxuID0gKGxhc3ROYW1lIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldL2csIFwiXCIpO1xuICBjb25zdCBmaXJzdEwgPSBsbi5zbGljZSgwLCAxKTtcbiAgY29uc3QgbGFzdEwgPSBsbi5zbGljZSgtMSk7XG4gIHJldHVybiBgJHtmbn0ke2ZpcnN0TH0ke2xhc3RMfTI1YDtcbn1cblxuZnVuY3Rpb24gaXNWYWxpZEZyb21PclJlcGx5VG8ocyA9IFwiXCIpIHtcbiAgcmV0dXJuIChcbiAgICAvXltePD5cXHNAXStAW148Plxcc0BdK1xcLltePD5cXHNAXSskLy50ZXN0KHMpIHx8XG4gICAgL15bXjw+XSs8W148Plxcc0BdK0BbXjw+XFxzQF0rXFwuW148Pl0rPiQvLnRlc3QocylcbiAgKTtcbn1cblxuZnVuY3Rpb24gc3RvcmFnZUtleUZvcihmaWxlTmFtZSwgcmVwQ29kZSkge1xuICBjb25zdCBkID0gbmV3IERhdGUoKTtcbiAgY29uc3QgeXl5eSA9IGQuZ2V0RnVsbFllYXIoKTtcbiAgY29uc3QgbW0gPSBTdHJpbmcoZC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgXCIwXCIpO1xuICBjb25zdCBmb2xkZXIgPSByZXBDb2RlID8gYCR7eXl5eX0vJHttbX0vJHtyZXBDb2RlfWAgOiBgJHt5eXl5fS8ke21tfWA7XG4gIHJldHVybiBgJHtmb2xkZXJ9LyR7ZmlsZU5hbWV9YDtcbn1cblxuZnVuY3Rpb24gc2FuaXRpemVDb3VudHMocmF3KSB7XG4gIGlmICghcmF3IHx8IHR5cGVvZiByYXcgIT09IFwib2JqZWN0XCIpIHJldHVybiBudWxsO1xuICBjb25zdCBrZXlzID0gW1wiYzEyM1wiLCBcImMxMlwiLCBcImMxXCJdO1xuICBjb25zdCBjbGVhbmVkID0ge307XG4gIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICBjb25zdCB2YWx1ZSA9IE51bWJlcihyYXdba2V5XSk7XG4gICAgaWYgKE51bWJlci5pc0Zpbml0ZSh2YWx1ZSkpIGNsZWFuZWRba2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhjbGVhbmVkKS5sZW5ndGggPyBjbGVhbmVkIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gY2xlYW5TdHJpbmcodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIHJldHVybiB0cmltbWVkLmxlbmd0aCA/IHRyaW1tZWQgOiBudWxsO1xufVxuXG4vLyAtLS0tLS0tLS0tIFBERiAtLS0tLS0tLS0tXG5hc3luYyBmdW5jdGlvbiBidWlsZFBkZihwLCBzaWdCeXRlcykge1xuICBjb25zdCBwZGYgPSBhd2FpdCBQREZEb2N1bWVudC5jcmVhdGUoKTtcbiAgY29uc3QgcGFnZSA9IHBkZi5hZGRQYWdlKFs1OTUsIDg0Ml0pOyAvLyBBNFxuICBjb25zdCB7IGhlaWdodCB9ID0gcGFnZS5nZXRTaXplKCk7XG4gIGNvbnN0IGZvbnQgPSBhd2FpdCBwZGYuZW1iZWRGb250KFN0YW5kYXJkRm9udHMuSGVsdmV0aWNhKTtcbiAgY29uc3QgYm9sZCA9IGF3YWl0IHBkZi5lbWJlZEZvbnQoU3RhbmRhcmRGb250cy5IZWx2ZXRpY2FCb2xkKTtcbiAgY29uc3QgZHJhdyA9ICh0eHQsIG9wdHMpID0+IHBhZ2UuZHJhd1RleHQodG9XaW5BbnNpKHR4dCksIG9wdHMpO1xuXG4gIGxldCB5ID0gaGVpZ2h0IC0gNzA7XG4gIGRyYXcoXCJBdWZ0cmFnc2Jlc3TDpHRpZ3VuZyBTdGVybmJsaXR6XCIsIHsgeDogNTAsIHksIGZvbnQ6IGJvbGQsIHNpemU6IDIwLCBjb2xvcjogcmdiKDAsMCwwKSB9KTtcblxuICB5IC09IDIwO1xuICBkcmF3KFwiSGllcm1pdCBiZXN0w6R0aWdlIGljaCBkZW4gQXVmdHJhZyB6dXIgTMO2c2NodW5nIG1laW5lciBuZWdhdGl2ZW4gR29vZ2xlLUJld2VydHVuZ2VuLlwiLCB7IHg6IDUwLCB5LCBmb250LCBzaXplOiAxMSwgY29sb3I6IHJnYigwLDAsMCkgfSk7XG5cbiAgeSAtPSAyNTtcbiAgZm9yIChjb25zdCBiIG9mIFtcbiAgICBcIkZpeHByZWlzOiAyOTkg4oKsIChlaW5tYWxpZylcIixcbiAgICBcIlphaGx1bmcgZXJzdCBuYWNoIEzDtnNjaHVuZyAodm9uIG1pbmQuIDkwICUgZGVyIEJld2VydHVuZ2VuKVwiLFxuICAgIFwiRGF1ZXJoYWZ0ZSBFbnRmZXJudW5nXCIsXG4gIF0pIHtcbiAgICBkcmF3KFwi4oCiIFwiICsgYiwgeyB4OiA1MCwgeSwgZm9udCwgc2l6ZTogMTEsIGNvbG9yOiByZ2IoMCwwLDApIH0pO1xuICAgIHkgLT0gMTY7XG4gIH1cblxuICB5IC09IDEwO1xuICBkcmF3KFwiWnVzYW1tZW5mYXNzdW5nXCIsIHsgeDogNTAsIHksIGZvbnQ6IGJvbGQsIHNpemU6IDEyLCBjb2xvcjogcmdiKDAsMCwwKSB9KTtcbiAgeSAtPSAxNjtcblxuICBjb25zdCBsaW5lcyA9IFtcbiAgICBbXCJHb29nbGUtUHJvZmlsXCIsIHAuZ29vZ2xlUHJvZmlsZV0sXG4gICAgW1wiQmV3ZXJ0dW5nZW5cIiwgbGFiZWxGb3IocC5zZWxlY3RlZE9wdGlvbildLFxuICAgIFtcIkZpcm1hXCIsIHAuY29tcGFueV0sXG4gICAgW1wiVm9ybmFtZVwiLCBwLmZpcnN0TmFtZV0sXG4gICAgW1wiTmFjaG5hbWVcIiwgcC5sYXN0TmFtZV0sXG4gICAgW1wiRS1NYWlsXCIsIHAuZW1haWxdLFxuICAgIFtcIlRlbGVmb25cIiwgcC5waG9uZV0sXG4gIF07XG4gIGZvciAoY29uc3QgW2ssIHZdIG9mIGxpbmVzKSB7XG4gICAgZHJhdyhgJHtrfTpgLCB7IHg6IDUwLCB5LCBmb250OiBib2xkLCBzaXplOiAxMCwgY29sb3I6IHJnYigwLDAsMCkgfSk7XG4gICAgZHJhdyhTdHJpbmcodiA/PyBcIuKAlFwiKSwgeyB4OiAxODAsIHksIGZvbnQsIHNpemU6IDEwLCBjb2xvcjogcmdiKDAsMCwwKSB9KTtcbiAgICB5IC09IDE0O1xuICB9XG5cbiAgY29uc3QgcGlja2VkID0gY2hvc2VuQ291bnQocC5zZWxlY3RlZE9wdGlvbiwgcC5jb3VudHMpO1xuICB5IC09IDY7XG4gIGRyYXcoXCJHZXfDpGhsdGUgTMO2c2NodW5nOlwiLCB7IHg6IDUwLCB5LCBmb250OiBib2xkLCBzaXplOiAxMCwgY29sb3I6IHJnYigwLDAsMCkgfSk7XG4gIGRyYXcoXG4gICAgYCR7bGFiZWxGb3IocC5zZWxlY3RlZE9wdGlvbil9JHtwaWNrZWQgIT0gbnVsbCA/IGAg4oCUIEVudGZlcm50ZTogJHtOdW1iZXIocGlja2VkKS50b0xvY2FsZVN0cmluZyhcImRlLURFXCIpfWAgOiBcIlwifWAsXG4gICAgeyB4OiAxODAsIHksIGZvbnQsIHNpemU6IDEwLCBjb2xvcjogcmdiKDAsMCwwKSB9XG4gICk7XG4gIHkgLT0gMTQ7XG5cbiAgaWYgKHAuY291bnRzKSB7XG4gICAgY29uc3QgYzEyMyA9IE51bWJlcihwLmNvdW50cy5jMTIzID8/IDApLnRvTG9jYWxlU3RyaW5nKFwiZGUtREVcIik7XG4gICAgY29uc3QgYzEyICA9IE51bWJlcihwLmNvdW50cy5jMTIgID8/IDApLnRvTG9jYWxlU3RyaW5nKFwiZGUtREVcIik7XG4gICAgY29uc3QgYzEgICA9IE51bWJlcihwLmNvdW50cy5jMSAgID8/IDApLnRvTG9jYWxlU3RyaW5nKFwiZGUtREVcIik7XG4gICAgZHJhdyhcIlrDpGhsZXIgZ2VzYW10OlwiLCB7IHg6IDUwLCB5LCBmb250OiBib2xkLCBzaXplOiAxMCwgY29sb3I6IHJnYigwLDAsMCkgfSk7XG4gICAgZHJhdyhgMeKAkzM6ICR7YzEyM30gICB8ICAgMeKAkzI6ICR7YzEyfSAgIHwgICAxOiAke2MxfWAsIHsgeDogMTgwLCB5LCBmb250LCBzaXplOiAxMCwgY29sb3I6IHJnYigwLDAsMCkgfSk7XG4gICAgeSAtPSAxNDtcbiAgfVxuXG4gIHkgLT0gMTI7XG4gIGRyYXcoXCJVbnRlcnNjaHJpZnQ6XCIsIHsgeDogNTAsIHksIGZvbnQ6IGJvbGQsIHNpemU6IDExLCBjb2xvcjogcmdiKDAsMCwwKSB9KTtcbiAgeSAtPSAxMDA7XG5cbiAgaWYgKHNpZ0J5dGVzPy5sZW5ndGgpIHtcbiAgICBjb25zdCBwbmcgPSBhd2FpdCBwZGYuZW1iZWRQbmcoc2lnQnl0ZXMpO1xuICAgIHBhZ2UuZHJhd0ltYWdlKHBuZywgeyB4OiA1MCwgeSwgd2lkdGg6IDIwMCwgaGVpZ2h0OiAxMDAgfSk7XG4gIH1cblxuICB5IC09IDIwO1xuICBkcmF3KGBEYXR1bTogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKFwiZGUtREVcIil9YCwgeyB4OiA1MCwgeSwgZm9udCwgc2l6ZTogMTAsIGNvbG9yOiByZ2IoMCwwLDApIH0pO1xuXG4gIHJldHVybiBhd2FpdCBwZGYuc2F2ZSgpO1xufVxuXG4vLyAtLS0tLS0tLS0tIEhhbmRsZXIgLS0tLS0tLS0tLVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3Qge1xuICAgICAgZ29vZ2xlUHJvZmlsZSxcbiAgICAgIGdvb2dsZVVybCxcbiAgICAgIHNlbGVjdGVkT3B0aW9uLFxuICAgICAgY29tcGFueSxcbiAgICAgIGZpcnN0TmFtZSxcbiAgICAgIGxhc3ROYW1lLFxuICAgICAgZW1haWwsXG4gICAgICBwaG9uZSxcbiAgICAgIHNpZ25hdHVyZVBuZyxcbiAgICAgIGNvdW50cywgICAgICAgICAgICAgICAgIC8vIHsgYzEyMywgYzEyLCBjMSB9XG4gICAgICByZXBfY29kZSA9IG51bGwsICAgICAgICAvLyBuZXU6IHdpcmQgbWl0Z2VzcGVpY2hlcnRcbiAgICAgIHNvdXJjZV9hY2NvdW50X2lkID0gbnVsbCwgLy8gbmV1OiB3aXJkIG1pdGdlc3BlaWNoZXJ0XG4gICAgfSA9IGJvZHkgfHwge307XG5cbiAgICBjb25zdCBub3JtYWxpemVkR29vZ2xlUHJvZmlsZSA9XG4gICAgICB0eXBlb2YgZ29vZ2xlUHJvZmlsZSA9PT0gXCJzdHJpbmdcIiA/IGdvb2dsZVByb2ZpbGUudHJpbSgpIDogZ29vZ2xlUHJvZmlsZTtcbiAgICBjb25zdCBub3JtYWxpemVkR29vZ2xlVXJsID0gY2xlYW5TdHJpbmcoZ29vZ2xlVXJsKTtcblxuICAgIGlmICghbm9ybWFsaXplZEdvb2dsZVByb2ZpbGUgfHwgIXNpZ25hdHVyZVBuZykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVW5nw7xsdGlnZSBEYXRlblwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBzdXBhYmFzZVNlcnZlckF1dGgoKTtcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICAgIGVycm9yOiB1c2VyRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuICAgIGlmICh1c2VyRXJyb3IpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiB1c2VyRXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlNlc3Npb24gZXJmb3JkZXJsaWNoLlwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJwcm9maWxlc1wiKVxuICAgICAgLnNlbGVjdChcInVzZXJfaWRcIilcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlci5pZClcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xuXG4gICAgaWYgKHByb2ZpbGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcInNpZ24vc3VibWl0IHByb2ZpbGUgZXJyb3JcIiwgcHJvZmlsZUVycm9yKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlByb2ZpbCBrb25udGUgbmljaHQgZ2VsYWRlbiB3ZXJkZW4uXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG4gICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiS2VpbiBQcm9maWwgaGludGVybGVndC4gQml0dGUgQWRtaW4gYmVuYWNocmljaHRpZ2VuLlwiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlX2FjY291bnRfaWQgJiYgc291cmNlX2FjY291bnRfaWQgIT09IHVzZXIuaWQpIHtcbiAgICAgIGNvbnNvbGUud2FybihcInNvdXJjZV9hY2NvdW50X2lkIGRvZXMgbm90IG1hdGNoIHNlc3Npb24gdXNlclwiLCB7XG4gICAgICAgIHNvdXJjZV9hY2NvdW50X2lkLFxuICAgICAgICB1c2VyX2lkOiB1c2VyLmlkLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gMSkgUERGIGJhdWVuXG4gICAgY29uc3Qgc2lnQnl0ZXMgPSBkYXRhVXJsVG9VaW50OChzaWduYXR1cmVQbmcpO1xuICAgIGNvbnN0IHBkZkJ5dGVzID0gYXdhaXQgYnVpbGRQZGYoXG4gICAgICB7XG4gICAgICAgIGdvb2dsZVByb2ZpbGU6IG5vcm1hbGl6ZWRHb29nbGVQcm9maWxlLFxuICAgICAgICBzZWxlY3RlZE9wdGlvbixcbiAgICAgICAgY29tcGFueSxcbiAgICAgICAgZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZSxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIHBob25lLFxuICAgICAgICBjb3VudHMsXG4gICAgICB9LFxuICAgICAgc2lnQnl0ZXNcbiAgICApO1xuXG4gICAgLy8gMikgVXBsb2FkIHp1IFN1cGFiYXNlIFN0b3JhZ2UgKEJ1Y2tldDogY29udHJhY3RzKVxuICAgIGNvbnN0IGFkbWluID0gc3VwYWJhc2VBZG1pbigpO1xuICAgIGNvbnN0IHNhZmVCYXNlID0gc2FmZUZpbGVCYXNlKGZpcnN0TmFtZSk7XG4gICAgY29uc3QgZmlsZU5hbWUgPSBgJHtEYXRlLm5vdygpfV8ke3NhZmVCYXNlfS5wZGZgO1xuICAgIGNvbnN0IGtleSA9IHN0b3JhZ2VLZXlGb3IoZmlsZU5hbWUsIHJlcF9jb2RlIHx8IHVuZGVmaW5lZCk7XG5cbiAgICBjb25zdCB7IGVycm9yOiB1cGxvYWRFcnIgfSA9IGF3YWl0IGFkbWluLnN0b3JhZ2VcbiAgICAgIC5mcm9tKFwiY29udHJhY3RzXCIpXG4gICAgICAudXBsb2FkKGtleSwgQnVmZmVyLmZyb20ocGRmQnl0ZXMpLCB7XG4gICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL3BkZlwiLFxuICAgICAgICB1cHNlcnQ6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgaWYgKHVwbG9hZEVycikgdGhyb3cgdXBsb2FkRXJyO1xuXG4gICAgY29uc3QgeyBkYXRhOiBwdWIgfSA9IGFkbWluLnN0b3JhZ2UuZnJvbShcImNvbnRyYWN0c1wiKS5nZXRQdWJsaWNVcmwoa2V5KTtcbiAgICBjb25zdCBwZGZVcmwgPSBwdWI/LnB1YmxpY1VybCB8fCBudWxsO1xuXG4gICAgLy8gMykgQXVmdHJhZyBzcGVpY2hlcnQgc2ljaCDDvGJlciBkYXMgUkxTLWbDpGhpZ2UgQ2xpZW50XG4gICAgY29uc3QgcGlja2VkID0gY2hvc2VuQ291bnQoc2VsZWN0ZWRPcHRpb24sIGNvdW50cyk7XG4gICAgY29uc3Qgc2FuaXRpemVkQ291bnRzID0gc2FuaXRpemVDb3VudHMoY291bnRzKTtcbiAgICBjb25zdCBvcmRlclBheWxvYWQgPSB7XG4gICAgICBnb29nbGVfcHJvZmlsZTogbm9ybWFsaXplZEdvb2dsZVByb2ZpbGUsXG4gICAgICBnb29nbGVfdXJsOiBub3JtYWxpemVkR29vZ2xlVXJsLFxuICAgICAgc2VsZWN0ZWRfb3B0aW9uOiBjbGVhblN0cmluZyhzZWxlY3RlZE9wdGlvbiksXG4gICAgICBjb3VudHM6IHNhbml0aXplZENvdW50cyxcbiAgICAgIGNvbXBhbnk6IGNsZWFuU3RyaW5nKGNvbXBhbnkpLFxuICAgICAgZmlyc3RfbmFtZTogY2xlYW5TdHJpbmcoZmlyc3ROYW1lKSxcbiAgICAgIGxhc3RfbmFtZTogY2xlYW5TdHJpbmcobGFzdE5hbWUpLFxuICAgICAgZW1haWw6IGNsZWFuU3RyaW5nKGVtYWlsKSxcbiAgICAgIHBob25lOiBjbGVhblN0cmluZyhwaG9uZSksXG4gICAgICBwZGZfcGF0aDoga2V5LFxuICAgICAgcGRmX3NpZ25lZF91cmw6IHBkZlVybCxcbiAgICB9O1xuXG4gICAgaWYgKHJlcF9jb2RlICYmIHR5cGVvZiByZXBfY29kZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgdHJpbW1lZCA9IHJlcF9jb2RlLnRyaW0oKTtcbiAgICAgIGlmICh0cmltbWVkKSBvcmRlclBheWxvYWQucmVwX2NvZGUgPSB0cmltbWVkO1xuICAgIH1cbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKHBpY2tlZCkpIHtcbiAgICAgIG9yZGVyUGF5bG9hZC5vcHRpb25fY2hvc2VuX2NvdW50ID0gcGlja2VkO1xuICAgIH1cbiAgICBpZiAoYm9keSAmJiB0eXBlb2YgYm9keS5jdXN0b21Ob3RlcyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgb3JkZXJQYXlsb2FkLmN1c3RvbV9ub3RlcyA9IGNsZWFuU3RyaW5nKGJvZHkuY3VzdG9tTm90ZXMpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogaW5zZXJ0ZWRPcmRlciwgZXJyb3I6IGluc2VydEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJvcmRlcnNcIilcbiAgICAgIC5pbnNlcnQoW29yZGVyUGF5bG9hZF0pXG4gICAgICAuc2VsZWN0KFwiaWQsIGNyZWF0ZWRfYXRcIilcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xuXG4gICAgaWYgKGluc2VydEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwib3JkZXJzIGluc2VydCBmYWlsZWRcIiwgaW5zZXJ0RXJyb3IpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYWRtaW4uc3RvcmFnZS5mcm9tKFwiY29udHJhY3RzXCIpLnJlbW92ZShba2V5XSk7XG4gICAgICB9IGNhdGNoIChjbGVhbnVwRXJyKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIm9yZGVycyBpbnNlcnQgY2xlYW51cCBmYWlsZWRcIiwgY2xlYW51cEVycik7XG4gICAgICB9XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJBdWZ0cmFnIGtvbm50ZSBuaWNodCBnZXNwZWljaGVydCB3ZXJkZW4uXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG5cbiAgICAvLyA0KSBFLU1haWwgdmlhIFJlc2VuZFxuICAgIGNvbnN0IHJlc2VuZCA9IG5ldyBSZXNlbmQocHJvY2Vzcy5lbnYuUkVTRU5EX0FQSV9LRVkpO1xuICAgIGNvbnN0IEZST00gPSBwcm9jZXNzLmVudi5SRVNFTkRfRlJPTSB8fCBcIlwiO1xuICAgIGNvbnN0IFJFUExZX1RPID0gcHJvY2Vzcy5lbnYuUkVTRU5EX1JFUExZX1RPIHx8IFwiXCI7XG4gICAgY29uc3QgQVRUQUNIID0gU3RyaW5nKHByb2Nlc3MuZW52LkVNQUlMX0FUVEFDSF9QREYgfHwgXCJcIikudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCI7XG5cbiAgICBjb25zdCBzdWJqZWN0ID0gXCJEZWluZSBBdWZ0cmFnc2Jlc3TDpHRpZ3VuZyDigJMgU3Rlcm5ibGl0elwiO1xuXG4gICAgY29uc3QgY2hvc2VuTGFiZWwgPSBsYWJlbEZvcihzZWxlY3RlZE9wdGlvbik7XG4gICAgY29uc3Qgc2VsZWN0ZWRDb3VudCA9IE51bWJlcihjaG9zZW5Db3VudChzZWxlY3RlZE9wdGlvbiwgY291bnRzKSA/PyAwKTtcbiAgICBjb25zdCBwcm9tbyA9IG1ha2VQcm9tb0NvZGUoZmlyc3ROYW1lLCBsYXN0TmFtZSk7XG4gICAgY29uc3QgcmVmZXJyYWxMaW5rID0gYGh0dHBzOi8vc3Rlcm5ibGl0ei5kZS9lbXBmZWhsZW4/cmVmPURFTU9gOyAvLyBQbGF0emhhbHRlclxuICAgIGNvbnN0IHBkZkxpbmUgPSBBVFRBQ0hcbiAgICAgID8gXCJEZWluZSBBdWZ0cmFnc2Jlc3TDpHRpZ3VuZyAoUERGKSBmaW5kZXN0IGR1IGltIEFuaGFuZy5cIlxuICAgICAgOiBcIkRlaW5lIEF1ZnRyYWdzYmVzdMOkdGlndW5nIChQREYpIHd1cmRlIGVyc3RlbGx0LlwiO1xuXG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTpJbnRlcixzeXN0ZW0tdWksLWFwcGxlLXN5c3RlbSxTZWdvZSBVSSxSb2JvdG8sQXJpYWwsc2Fucy1zZXJpZjtsaW5lLWhlaWdodDoxLjU4O2NvbG9yOiMwZjE3MmE7YmFja2dyb3VuZDojZmZmZmZmO3BhZGRpbmc6MDttYXJnaW46MFwiPlxuICAgICAgICA8ZGl2IHN0eWxlPVwibWF4LXdpZHRoOjY0MHB4O21hcmdpbjowIGF1dG87cGFkZGluZzoyOHB4IDIwcHggOHB4XCI+XG4gICAgICAgICAgPGgxIHN0eWxlPVwibWFyZ2luOjAgMCAxMHB4O2ZvbnQtc2l6ZToyMHB4O2xldHRlci1zcGFjaW5nOi4ycHhcIj5IYWxsbyAke2ZpcnN0TmFtZSB8fCBcIlwifSE8L2gxPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOjAgMCAxNnB4XCI+ZGFua2UgZsO8ciBkZWluZW4gQXVmdHJhZy4gV2lyIHN0YXJ0ZW4gamV0enQgbWl0IGRlciBFbnRmZXJudW5nIGRlciBhdXNnZXfDpGhsdGVuIEJld2VydHVuZ2VuLjwvcD5cblxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czoxNHB4O3BhZGRpbmc6MTRweCAxNnB4O21hcmdpbjoxOHB4IDA7YmFja2dyb3VuZDojZjlmYmZmXCI+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1zaXplOjEycHg7Y29sb3I6IzY0NzQ4Yjt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA2ZW07bWFyZ2luLWJvdHRvbTo2cHhcIj5Hb29nbGUtUHJvZmlsPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC13ZWlnaHQ6NzAwXCI+JHtub3JtYWxpemVkR29vZ2xlUHJvZmlsZSA/IG5vcm1hbGl6ZWRHb29nbGVQcm9maWxlIDogXCLigJRcIn08L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czoxNHB4O3BhZGRpbmc6MTRweCAxNnB4O21hcmdpbjoxMnB4IDA7YmFja2dyb3VuZDojZmZmZmZmXCI+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1zaXplOjEycHg7Y29sb3I6IzY0NzQ4Yjt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA2ZW07bWFyZ2luLWJvdHRvbTo2cHhcIj5BdXN3YWhsPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC13ZWlnaHQ6NzAwXCI+JHtjaG9zZW5MYWJlbH0g4oaSICR7TnVtYmVyLmlzRmluaXRlKHNlbGVjdGVkQ291bnQpID8gc2VsZWN0ZWRDb3VudCA6IFwi4oCUXCJ9IFN0w7xjazwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46MTZweCAwXCI+JHtwZGZMaW5lfTwvcD5cblxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW46MjZweCAwIDEwcHg7Zm9udC13ZWlnaHQ6ODAwO2ZvbnQtc2l6ZToxNnB4XCI+RnJldW5kZSB3ZXJiZW4gJiBzcGFyZW48L2Rpdj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjowIDAgMTJweFwiPlxuICAgICAgICAgICAgVGVpbGUgU3Rlcm5ibGl0eiBtaXQgRnJldW5kOmlubmVuIOKAkyA8c3Ryb25nPnNpZSBzcGFyZW4gMjUmbmJzcDvigqw8L3N0cm9uZz4gYXVmIGRpZSBBdWZ0cmFnc3BhdXNjaGFsZVxuICAgICAgICAgICAgdW5kIGR1IGVyaMOkbHRzdCBmw7xyIGplZGUgZXJmb2xncmVpY2hlIEVtcGZlaGx1bmcgZWluZW4gPHN0cm9uZz4yNSZuYnNwO+KCrCBBbWF6b24tR3V0c2NoZWluPC9zdHJvbmc+LlxuICAgICAgICAgIDwvcD5cblxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjEycHggMTRweDtib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czoxMnB4O2JhY2tncm91bmQ6I2Y3ZmFmYzttYXJnaW4tYm90dG9tOjEwcHhcIj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LXNpemU6MTJweDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA2ZW07Y29sb3I6IzY0NzQ4YlwiPkRlaW4gUHJvbW9jb2RlPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1zaXplOjIwcHg7Zm9udC13ZWlnaHQ6OTAwO2xldHRlci1zcGFjaW5nOi42cHhcIj4ke3Byb21vfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImZvbnQtc2l6ZToxMnB4O2NvbG9yOiM2NDc0OGJcIj5Hw7xsdGlnIDMwIFRhZ2UgwrcgbWF4LiA1IEVpbmzDtnN1bmdlbjwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbjo2cHggMCAyMnB4O2ZvbnQtc2l6ZToxNHB4XCI+XG4gICAgICAgICAgICBUZWlsZW4tTGluayAoUGxhdHpoYWx0ZXIpOlxuICAgICAgICAgICAgPGEgaHJlZj1cIiR7cmVmZXJyYWxMaW5rfVwiIHRhcmdldD1cIl9ibGFua1wiIHJlbD1cIm5vb3BlbmVyXCIgc3R5bGU9XCJjb2xvcjojMGI2Y2YyO3RleHQtZGVjb3JhdGlvbjpub25lXCI+JHtyZWZlcnJhbExpbmt9PC9hPlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPHAgc3R5bGU9XCJjb2xvcjojNjQ3NDhiO2ZvbnQtc3R5bGU6aXRhbGljO21hcmdpbi10b3A6NnB4XCI+KERpZXMgaXN0IGVpbmUgYXV0b21hdGlzY2hlIE1haWwpPC9wPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IHN0eWxlPVwibWF4LXdpZHRoOjY0MHB4O21hcmdpbjowIGF1dG87cGFkZGluZzowIDIwcHggMjhweFwiPlxuICAgICAgICAgIDxociBzdHlsZT1cImJvcmRlcjpub25lO2JvcmRlci10b3A6MXB4IHNvbGlkICNlNWU3ZWI7bWFyZ2luOjE0cHggMCAxOHB4XCIvPlxuICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZVwiPlxuICAgICAgICAgICAgPHRyPjx0ZCBzdHlsZT1cImZvbnQtd2VpZ2h0OjkwMDtwYWRkaW5nOjAgMCA2cHhcIj5TdGVybmJsaXR6IEF1ZnRyYWdzc2VydmljZTwvdGQ+PC90cj5cbiAgICAgICAgICAgIDx0cj48dGQgc3R5bGU9XCJwYWRkaW5nOjAgMCA0cHhcIj7wn5OnIDxhIGhyZWY9XCJtYWlsdG86aW5mb0BzdGVybmJsaXR6LmRlXCIgc3R5bGU9XCJjb2xvcjojMGI2Y2YyO3RleHQtZGVjb3JhdGlvbjpub25lXCI+aW5mb0BzdGVybmJsaXR6LmRlPC9hPjwvdGQ+PC90cj5cbiAgICAgICAgICAgIDx0cj48dGQ+8J+MkCA8YSBocmVmPVwiaHR0cHM6Ly9zdGVybmJsaXR6LmRlXCIgc3R5bGU9XCJjb2xvcjojMGI2Y2YyO3RleHQtZGVjb3JhdGlvbjpub25lXCI+c3Rlcm5ibGl0ei5kZTwvYT48L3RkPjwvdHI+XG4gICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgLnRyaW0oKTtcblxuICAgIGNvbnN0IHRleHQgPVxuICAgICAgYEhhbGxvICR7Zmlyc3ROYW1lIHx8IFwiXCJ9IVxcblxcbmAgK1xuICAgICAgYERhbmtlIGbDvHIgZGVpbmVuIEF1ZnRyYWcuIFdpciBzdGFydGVuIGpldHp0IG1pdCBkZXIgRW50ZmVybnVuZyBkZXIgYXVzZ2V3w6RobHRlbiBCZXdlcnR1bmdlbi5cXG5cXG5gICtcbiAgICAgIGBHb29nbGUtUHJvZmlsOiAke25vcm1hbGl6ZWRHb29nbGVQcm9maWxlIHx8IFwi4oCUXCJ9XFxuYCArXG4gICAgICBgQXVzd2FobDogJHtjaG9zZW5MYWJlbH0g4oaSICR7TnVtYmVyLmlzRmluaXRlKHNlbGVjdGVkQ291bnQpID8gc2VsZWN0ZWRDb3VudCA6IFwi4oCUXCJ9IFN0w7xja1xcblxcbmAgK1xuICAgICAgYCR7cGRmTGluZX1cXG5cXG5gICtcbiAgICAgIGBGcmV1bmRlIHdlcmJlbiAmIHNwYXJlbjpcXG5gICtcbiAgICAgIGDigKIgRGVpbmUgRnJldW5kZSBzcGFyZW4gMjUg4oKsIGF1ZiBkaWUgQXVmdHJhZ3NwYXVzY2hhbGVcXG5gICtcbiAgICAgIGDigKIgRHUgZXJow6RsdHN0IHBybyBlcmZvbGdyZWljaGVyIEVtcGZlaGx1bmcgZWluZW4gMjUg4oKsIEFtYXpvbi1HdXRzY2hlaW5cXG5gICtcbiAgICAgIGBQcm9tb2NvZGU6ICR7cHJvbW99ICgzMCBUYWdlIGfDvGx0aWcsIG1heC4gNSBFaW5sw7ZzdW5nZW4pXFxuYCArXG4gICAgICBgVGVpbGVuLUxpbmsgKFBsYXR6aGFsdGVyKTogJHtyZWZlcnJhbExpbmt9XFxuXFxuYCArXG4gICAgICBgKERpZXMgaXN0IGVpbmUgYXV0b21hdGlzY2hlIE1haWwpXFxuXFxuYCArXG4gICAgICBgU3Rlcm5ibGl0eiBBdWZ0cmFnc3NlcnZpY2VcXG5gICtcbiAgICAgIGBpbmZvQHN0ZXJuYmxpdHouZGUgwrcgc3Rlcm5ibGl0ei5kZVxcbmA7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuUkVTRU5EX0FQSV9LRVkgJiYgaXNWYWxpZEZyb21PclJlcGx5VG8ocHJvY2Vzcy5lbnYuUkVTRU5EX0ZST00gfHwgXCJcIikpIHtcbiAgICAgIGlmIChlbWFpbCkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAgIGZyb206IHByb2Nlc3MuZW52LlJFU0VORF9GUk9NLFxuICAgICAgICAgIHRvOiBlbWFpbCxcbiAgICAgICAgICBzdWJqZWN0LFxuICAgICAgICAgIGh0bWwsXG4gICAgICAgICAgdGV4dCxcbiAgICAgICAgICBoZWFkZXJzOiB7IFwiWC1FbnRpdHktUmVmLUlEXCI6IGtleSB9LFxuICAgICAgICAgIC4uLihpc1ZhbGlkRnJvbU9yUmVwbHlUbyhwcm9jZXNzLmVudi5SRVNFTkRfUkVQTFlfVE8gfHwgXCJcIikgPyB7IHJlcGx5X3RvOiBwcm9jZXNzLmVudi5SRVNFTkRfUkVQTFlfVE8gfSA6IHt9KSxcbiAgICAgICAgICAuLi4oQVRUQUNIID8ge1xuICAgICAgICAgICAgYXR0YWNobWVudHM6IFt7XG4gICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlTmFtZSxcbiAgICAgICAgICAgICAgY29udGVudDogQnVmZmVyLmZyb20ocGRmQnl0ZXMpLFxuICAgICAgICAgICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9wZGZcIixcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgIH0gOiB7fSksXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHsgZXJyb3I6IG1haWxFcnIgfSA9IGF3YWl0IHJlc2VuZC5lbWFpbHMuc2VuZChwYXlsb2FkKTtcbiAgICAgICAgaWYgKG1haWxFcnIpIGNvbnNvbGUud2FybihcIlJlc2VuZCBlcnJvcjpcIiwgbWFpbEVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJLZWluIEVtcGbDpG5nZXIgKGVtYWlsKSBhbmdlZ2ViZW4g4oCTIEUtTWFpbCDDvGJlcnNwcnVuZ2VuLlwiKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKFwiRS1NYWlsIG5pY2h0IGdlc2VuZGV0OiBSRVNFTkRfQVBJX0tFWS9SRVNFTkRfRlJPTSBmZWhsdCBvZGVyIHVuZ8O8bHRpZy5cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIG9rOiB0cnVlLFxuICAgICAgcGRmVXJsLFxuICAgICAgcGRmUGF0aDoga2V5LFxuICAgICAgb3JkZXJJZDogaW5zZXJ0ZWRPcmRlcj8uaWQgPz8gbnVsbCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJzaWduL3N1Ym1pdCBlcnJvcjpcIiwgZSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGU/Lm1lc3NhZ2UgfHwgXCJGZWhsZXJcIiB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiUERGRG9jdW1lbnQiLCJTdGFuZGFyZEZvbnRzIiwicmdiIiwiUmVzZW5kIiwic3VwYWJhc2VBZG1pbiIsInN1cGFiYXNlU2VydmVyQXV0aCIsInJ1bnRpbWUiLCJkYXRhVXJsVG9VaW50OCIsInNpZ25hdHVyZVBuZyIsImJhc2U2NCIsInNwbGl0IiwicG9wIiwiYmluIiwiQnVmZmVyIiwiZnJvbSIsIlVpbnQ4QXJyYXkiLCJ0b1dpbkFuc2kiLCJ0ZXh0IiwiU3RyaW5nIiwicmVwbGFjZSIsImxhYmVsRm9yIiwib3B0IiwiY2hvc2VuQ291bnQiLCJzZWxlY3RlZE9wdGlvbiIsImNvdW50cyIsImMxMjMiLCJjMTIiLCJjMSIsInNhZmVGaWxlQmFzZSIsIm5hbWUiLCJ0b1N0cmluZyIsInRyaW0iLCJtYWtlUHJvbW9Db2RlIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJmbiIsInRvTG93ZXJDYXNlIiwibG4iLCJmaXJzdEwiLCJzbGljZSIsImxhc3RMIiwiaXNWYWxpZEZyb21PclJlcGx5VG8iLCJzIiwidGVzdCIsInN0b3JhZ2VLZXlGb3IiLCJmaWxlTmFtZSIsInJlcENvZGUiLCJkIiwiRGF0ZSIsInl5eXkiLCJnZXRGdWxsWWVhciIsIm1tIiwiZ2V0TW9udGgiLCJwYWRTdGFydCIsImZvbGRlciIsInNhbml0aXplQ291bnRzIiwicmF3Iiwia2V5cyIsImNsZWFuZWQiLCJrZXkiLCJ2YWx1ZSIsIk51bWJlciIsImlzRmluaXRlIiwiT2JqZWN0IiwibGVuZ3RoIiwiY2xlYW5TdHJpbmciLCJ0cmltbWVkIiwiYnVpbGRQZGYiLCJwIiwic2lnQnl0ZXMiLCJwZGYiLCJjcmVhdGUiLCJwYWdlIiwiYWRkUGFnZSIsImhlaWdodCIsImdldFNpemUiLCJmb250IiwiZW1iZWRGb250IiwiSGVsdmV0aWNhIiwiYm9sZCIsIkhlbHZldGljYUJvbGQiLCJkcmF3IiwidHh0Iiwib3B0cyIsImRyYXdUZXh0IiwieSIsIngiLCJzaXplIiwiY29sb3IiLCJiIiwibGluZXMiLCJnb29nbGVQcm9maWxlIiwiY29tcGFueSIsImVtYWlsIiwicGhvbmUiLCJrIiwidiIsInBpY2tlZCIsInRvTG9jYWxlU3RyaW5nIiwicG5nIiwiZW1iZWRQbmciLCJkcmF3SW1hZ2UiLCJ3aWR0aCIsInNhdmUiLCJQT1NUIiwicmVxIiwiYm9keSIsImpzb24iLCJnb29nbGVVcmwiLCJyZXBfY29kZSIsInNvdXJjZV9hY2NvdW50X2lkIiwibm9ybWFsaXplZEdvb2dsZVByb2ZpbGUiLCJub3JtYWxpemVkR29vZ2xlVXJsIiwiZXJyb3IiLCJzdGF0dXMiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwidXNlckVycm9yIiwiYXV0aCIsImdldFVzZXIiLCJtZXNzYWdlIiwicHJvZmlsZSIsInByb2ZpbGVFcnJvciIsInNlbGVjdCIsImVxIiwiaWQiLCJtYXliZVNpbmdsZSIsImNvbnNvbGUiLCJ3YXJuIiwidXNlcl9pZCIsInBkZkJ5dGVzIiwiYWRtaW4iLCJzYWZlQmFzZSIsIm5vdyIsInVuZGVmaW5lZCIsInVwbG9hZEVyciIsInN0b3JhZ2UiLCJ1cGxvYWQiLCJjb250ZW50VHlwZSIsInVwc2VydCIsInB1YiIsImdldFB1YmxpY1VybCIsInBkZlVybCIsInB1YmxpY1VybCIsInNhbml0aXplZENvdW50cyIsIm9yZGVyUGF5bG9hZCIsImdvb2dsZV9wcm9maWxlIiwiZ29vZ2xlX3VybCIsInNlbGVjdGVkX29wdGlvbiIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJwZGZfcGF0aCIsInBkZl9zaWduZWRfdXJsIiwib3B0aW9uX2Nob3Nlbl9jb3VudCIsImN1c3RvbU5vdGVzIiwiY3VzdG9tX25vdGVzIiwiaW5zZXJ0ZWRPcmRlciIsImluc2VydEVycm9yIiwiaW5zZXJ0IiwicmVtb3ZlIiwiY2xlYW51cEVyciIsInJlc2VuZCIsInByb2Nlc3MiLCJlbnYiLCJSRVNFTkRfQVBJX0tFWSIsIkZST00iLCJSRVNFTkRfRlJPTSIsIlJFUExZX1RPIiwiUkVTRU5EX1JFUExZX1RPIiwiQVRUQUNIIiwiRU1BSUxfQVRUQUNIX1BERiIsInN1YmplY3QiLCJjaG9zZW5MYWJlbCIsInNlbGVjdGVkQ291bnQiLCJwcm9tbyIsInJlZmVycmFsTGluayIsInBkZkxpbmUiLCJodG1sIiwicGF5bG9hZCIsInRvIiwiaGVhZGVycyIsInJlcGx5X3RvIiwiYXR0YWNobWVudHMiLCJmaWxlbmFtZSIsImNvbnRlbnQiLCJtYWlsRXJyIiwiZW1haWxzIiwic2VuZCIsIm9rIiwicGRmUGF0aCIsIm9yZGVySWQiLCJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/sign/submit/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseServer.js":
/*!*******************************!*\
  !*** ./lib/supabaseServer.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nlet adminClient;\nfunction supabaseAdmin() {\n    if (!adminClient) {\n        const url = process.env.SUPABASE_URL || \"https://iexrsxsfqzxuafhblhhd.supabase.co\";\n        const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!url || !serviceRoleKey) {\n            throw new Error(\"Supabase Server: Fehlende Umgebungsvariablen (URL oder SERVICE_ROLE_KEY)\");\n        }\n        adminClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, serviceRoleKey, {\n            auth: {\n                persistSession: false,\n                autoRefreshToken: false\n            }\n        });\n    }\n    return adminClient;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VTZXJ2ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFFckQsSUFBSUM7QUFFRyxTQUFTQztJQUNkLElBQUksQ0FBQ0QsYUFBYTtRQUNoQixNQUFNRSxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSUYsMENBQW9DO1FBQzVFLE1BQU1JLGlCQUFpQkosUUFBUUMsR0FBRyxDQUFDSSx5QkFBeUI7UUFFNUQsSUFBSSxDQUFDTixPQUFPLENBQUNLLGdCQUFnQjtZQUMzQixNQUFNLElBQUlFLE1BQU07UUFDbEI7UUFFQVQsY0FBY0QsbUVBQVlBLENBQUNHLEtBQUtLLGdCQUFnQjtZQUM5Q0csTUFBTTtnQkFBRUMsZ0JBQWdCO2dCQUFPQyxrQkFBa0I7WUFBTTtRQUN6RDtJQUNGO0lBQ0EsT0FBT1o7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3N0ZXJuYmxpdHotc2FsZXMvLi9saWIvc3VwYWJhc2VTZXJ2ZXIuanM/NWM3MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmxldCBhZG1pbkNsaWVudDtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1cGFiYXNlQWRtaW4oKSB7XG4gIGlmICghYWRtaW5DbGllbnQpIHtcbiAgICBjb25zdCB1cmwgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICAgIGNvbnN0IHNlcnZpY2VSb2xlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWTtcblxuICAgIGlmICghdXJsIHx8ICFzZXJ2aWNlUm9sZUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3VwYWJhc2UgU2VydmVyOiBGZWhsZW5kZSBVbWdlYnVuZ3N2YXJpYWJsZW4gKFVSTCBvZGVyIFNFUlZJQ0VfUk9MRV9LRVkpXCIpO1xuICAgIH1cblxuICAgIGFkbWluQ2xpZW50ID0gY3JlYXRlQ2xpZW50KHVybCwgc2VydmljZVJvbGVLZXksIHtcbiAgICAgIGF1dGg6IHsgcGVyc2lzdFNlc3Npb246IGZhbHNlLCBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSB9LFxuICAgIH0pO1xuICB9XG4gIHJldHVybiBhZG1pbkNsaWVudDtcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJhZG1pbkNsaWVudCIsInN1cGFiYXNlQWRtaW4iLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic2VydmljZVJvbGVLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiRXJyb3IiLCJhdXRoIiwicGVyc2lzdFNlc3Npb24iLCJhdXRvUmVmcmVzaFRva2VuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseServer.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseServerAuth.js":
/*!***********************************!*\
  !*** ./lib/supabaseServerAuth.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseServerAuth: () => (/* binding */ supabaseServerAuth)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(rsc)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__);\n// lib/supabaseServerAuth.js\n\n\nfunction supabaseServerAuth() {\n    const supabaseUrl = process.env.SUPABASE_URL || \"https://iexrsxsfqzxuafhblhhd.supabase.co\";\n    const anonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlleHJzeHNmcXp4dWFmaGJsaGhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDIyOTcsImV4cCI6MjA3NjIxODI5N30.aeAT2ZmBHDRcxpMrHdKe1kPLZITmGM-qq_Wm4uJ9OAk\";\n    if (!supabaseUrl || !anonKey) {\n        throw new Error(\"Missing SUPABASE_URL / NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n    }\n    return (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__.createRouteHandlerClient)({\n        cookies: next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies\n    }, {\n        supabaseUrl,\n        supabaseKey: anonKey\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VTZXJ2ZXJBdXRoLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSw0QkFBNEI7QUFDVztBQUNrQztBQUVsRSxTQUFTRTtJQUNkLE1BQU1DLGNBQWNDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWSxJQUFJRiwwQ0FBb0M7SUFDcEYsTUFBTUksVUFBVUosa05BQXlDO0lBQ3pELElBQUksQ0FBQ0QsZUFBZSxDQUFDSyxTQUFTO1FBQzVCLE1BQU0sSUFBSUUsTUFBTTtJQUNsQjtJQUNBLE9BQU9ULHVGQUF3QkEsQ0FDN0I7UUFBRUQsT0FBT0EsbURBQUFBO0lBQUMsR0FDVjtRQUNFRztRQUNBUSxhQUFhSDtJQUNmO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdGVybmJsaXR6LXNhbGVzLy4vbGliL3N1cGFiYXNlU2VydmVyQXV0aC5qcz8xOWQwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdXBhYmFzZVNlcnZlckF1dGguanNcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XG5pbXBvcnQgeyBjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL2F1dGgtaGVscGVycy1uZXh0anNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1cGFiYXNlU2VydmVyQXV0aCgpIHtcbiAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICBjb25zdCBhbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIWFub25LZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIFNVUEFCQVNFX1VSTCAvIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCBvciBORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWVwiKTtcbiAgfVxuICByZXR1cm4gY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50KFxuICAgIHsgY29va2llcyB9LFxuICAgIHtcbiAgICAgIHN1cGFiYXNlVXJsLFxuICAgICAgc3VwYWJhc2VLZXk6IGFub25LZXksXG4gICAgfVxuICApO1xufVxuIl0sIm5hbWVzIjpbImNvb2tpZXMiLCJjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQiLCJzdXBhYmFzZVNlcnZlckF1dGgiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJTVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJhbm9uS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJFcnJvciIsInN1cGFiYXNlS2V5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseServerAuth.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/set-cookie-parser","vendor-chunks/webidl-conversions","vendor-chunks/jose","vendor-chunks/pdf-lib","vendor-chunks/@pdf-lib","vendor-chunks/pako","vendor-chunks/entities","vendor-chunks/domutils","vendor-chunks/js-beautify","vendor-chunks/htmlparser2","vendor-chunks/peberminta","vendor-chunks/domhandler","vendor-chunks/dom-serializer","vendor-chunks/selderee","vendor-chunks/resend","vendor-chunks/parseley","vendor-chunks/leac","vendor-chunks/html-to-text","vendor-chunks/domelementtype","vendor-chunks/@selderee","vendor-chunks/@react-email","vendor-chunks/deepmerge"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsign%2Fsubmit%2Froute&page=%2Fapi%2Fsign%2Fsubmit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsign%2Fsubmit%2Froute.js&appDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flanoaziz%2FDesktop%2Fsternblitz-app-v3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();